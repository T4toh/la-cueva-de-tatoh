<div class="settings-container">
  <h1>Configuraci√≥n</h1>

  <!-- Auth Panel - Oculto en Android -->
  @if (!isAndroid) {
    <lib-panel
      [colorFondo]="'var(--color-1)'"
      [colorTexto]="'white'"
      [sombreado]="true"
      [texto]="'Sincronizaci√≥n en la Nube'"
    >
      @if (authService.user$ | async; as user) {
        <div class="settings-content">
          <div class="actions">
            <p>Conectado como: <strong>{{ user.email }}</strong></p>

            <div class="sync-status">
              @switch (mealService.syncStatus()) {
                @case ('synced') {
                  <span class="status-badge synced">‚úì Sincronizado</span>
                }
                @case ('loading') {
                  <span class="status-badge loading">‚è≥ Sincronizando...</span>
                }
                @case ('local-newer') {
                  <span class="status-badge local-newer">üì§ Subiendo datos locales...</span>
                }
                @case ('error') {
                  <span class="status-badge error">‚ö†Ô∏è Error de sincronizaci√≥n</span>
                }
                @case ('offline') {
                  <span class="status-badge offline">üì¥ Sin conexi√≥n</span>
                }
              }
              <p class="last-updated">√öltima actualizaci√≥n: {{ mealService.getLastUpdatedDisplay() }}</p>
            </div>

            <button class="btn-secondary" type="button" (click)="refreshData()">
              üîÑ Descargar de la Nube
            </button>
            <button class="btn-secondary" type="button" (click)="forceUpload()">
              üì§ Subir a la Nube
            </button>
            <button class="btn-danger" type="button" (click)="authService.logout()">
              Cerrar Sesi√≥n
            </button>
          </div>
        </div>
      } @else {
        <div class="settings-content">
          <div class="actions">
            <p>Inicia sesi√≥n con Google para guardar y sincronizar tus comidas en la nube de forma gratuita.</p>
            <button class="btn-google" type="button" (click)="authService.loginWithGoogle()">
              Iniciar sesi√≥n con Google
            </button>
          </div>
        </div>
      }
    </lib-panel>
  }

  <lib-panel 
    [colorFondo]="'var(--color-3)'" 
    [colorTexto]="'white'"
    [sombreado]="true"
    [texto]="'Gesti√≥n de Datos Local'"
  >
    <div class="settings-content">
      <p>Exporta tus comidas y planificaci√≥n para usarlas en otro dispositivo o guardarlas como copia de seguridad.</p>
      
      <div class="actions">
        <button class="btn-primary" type="button" (click)="mealService.exportData()">
          üì§ Exportar JSON
        </button>
        
        <label class="btn-secondary">
          üì• Importar JSON
          <input accept=".json" style="display: none;" type="file" (change)="onFileSelected($event)">
        </label>
      </div>
    </div>
  </lib-panel>

  <div class="version">
    <p>Comidas v1.2.0</p>
  </div>
</div>