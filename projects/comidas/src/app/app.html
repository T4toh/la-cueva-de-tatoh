<div class="app-container">
  <nav class="main-nav">
    <a routerLink="/" routerLinkActive="active" title="Plan Semanal" [routerLinkActiveOptions]="{exact: true}">
      <span class="icon">ğŸ“…</span>
      <span class="text">Plan</span>
    </a>
    <a routerLink="/meals" routerLinkActive="active" title="Mis Comidas">
      <span class="icon">ğŸ²</span>
      <span class="text">Comidas</span>
    </a>
    <a routerLink="/shopping-list" routerLinkActive="active" title="Lista de Compras">
      <span class="icon">ğŸ›’</span>
      <span class="text">Compras</span>
    </a>
    
    <!-- Auth & Config Logic -->
    @if (authService.user$ | async; as user) {
      <!-- Logged in: Avatar replaces the config button -->
      <a class="auth-link" routerLink="/settings" routerLinkActive="active" title="ConfiguraciÃ³n">
        <img alt="User" class="user-avatar" height="32" referrerpolicy="no-referrer" width="32" [src]="user.photoURL">
        <span class="text">Config</span>
      </a>
    } @else {
      <!-- Guest: Standard config button + login button -->
      <a routerLink="/settings" routerLinkActive="active" title="ConfiguraciÃ³n">
        <span class="icon">âš™ï¸</span>
        <span class="text">Config</span>
      </a>
      <button class="auth-link clickable" title="Iniciar SesiÃ³n" type="button" (click)="login()">
        <span class="icon">ğŸ‘¤</span>
        <span class="text">Entrar</span>
      </button>
    }

  </nav>

  <main>
    <router-outlet />
  </main>

  <lib-dialogo
    [acciones]="dialogService.actions()"
    [mensaje]="dialogService.message()"
    [titulo]="dialogService.title()"
    [visible]="dialogService.visible()"
    (visibleChange)="dialogService.visible.set($event)"
  />
</div>
